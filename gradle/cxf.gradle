configurations { cxf }

dependencies {
    def cxfVersion = '3.0.1'
    cxf 'org.apache.cxf:cxf-tools-wsdlto-core:' + cxfVersion
    cxf 'org.apache.cxf:cxf-tools-wsdlto-frontend-jaxws:' + cxfVersion
    cxf 'org.apache.cxf:cxf-tools-wsdlto-databinding-jaxb:' + cxfVersion
}

task wsdl2java(type: JavaExec) {
	ext {
        wsdlFile = new String()
		outputDir = file("$buildDir/generated-src")
	}

	// Main Java class to invoke.
	main = 'org.apache.cxf.tools.wsdlto.WSDLToJava'

	// Set classpath to dependencies assigned
	// to the cxf configuration.
	classpath = configurations.cxf

	// Arguments to be passed to WSDLToJava.
	args '-d', outputDir
	args '-client'
	args '-verbose'
	args '-validate'

    project.gradle.projectsEvaluated {
        inputs.property('wsdlFile', wsdlFile)
        outputs.dir outputDir
        args wsdlFile
	}

    doFirst {
        delete outputDir
    }
}
